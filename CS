def bundle_match(T5, Invoice_table):
    matching_invoices = []
    total_invoice_source_amt = 0
    match_rule = None

    for rule_index, rule in enumerate(rules, start=1):
        invoice_group = []
        rule_total_invoice_source_amt = 0

        for Invoice in Invoice_table:
            if rule(T5, Invoice=Invoice):
                invoice_group.append(Invoice)
                rule_total_invoice_source_amt += int(Invoice['inv_match_source_amt'])

        if rule_total_invoice_source_amt == int(T5['fin_source_amt']):
            matching_invoices.extend([(invoice, rule_index) for invoice in invoice_group])
            match_rule = rule_index
            total_invoice_source_amt = rule_total_invoice_source_amt

    if total_invoice_source_amt == int(T5['fin_source_amt']):
        return matching_invoices, match_rule

    return [], None
