from itertools import combinations


def bundle_match(T5, Invoice_table):
    matching_invoices = []
    match_rule = None

    for i in range(1, len(Invoice_table) + 1):
        for combination in combinations(Invoice_table, i):
            total_invoice_source_amt = sum(invoice['inv_match_source_amt'] for invoice in combination)
            if total_invoice_source_amt == T5['fin_source_amt']:
                for invoice in combination:
                    matching_invoices.append((invoice, i))
                match_rule = i

    if matching_invoices:
        return matching_invoices, match_rule
    return [], None
