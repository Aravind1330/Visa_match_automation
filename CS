import pandas as pd

# Load the transaction data and invoice data into DataFrames
transaction_data = pd.read_csv('transaction_data.csv')
invoice_data = pd.read_csv('invoice_data.csv')

# Match invoices with transactions based on the pattern
matched_invoices = []
for _, invoice_row in invoice_data.iterrows():
    invoice_supplier = invoice_row['Supplier Name']
    invoice_ticket = str(invoice_row['Ticket No'])[:5]  # Extract first 5 digits of the invoice ticket number

    matched_transaction = transaction_data[
        transaction_data['Supplier Name'].str.contains(invoice_supplier) &
        transaction_data['Ticket No'].astype(str).str[:5].str.contains(invoice_ticket)
    ]

    if not matched_transaction.empty:
        matched_invoice = {
            'Invoice': invoice_row['Ticket No'],
            'Matched Transaction': matched_transaction['Transaction ID'].values[0]
        }
        matched_invoices.append(matched_invoice)

# Display the matched results
matched_df = pd.DataFrame(matched_invoices)
print(matched_df)
