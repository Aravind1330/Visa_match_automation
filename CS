def match_bundle(T5, Invoice_table):
    matching_invoices = []
    total_invoice_source_amt = 0
    match_rule = None

    for rule_index, rule in enumerate(rules, start=1):
        for i, Invoice in enumerate(Invoice_table):
            if rule(T5, Invoice=Invoice):
                matching_invoices.append((Invoice, rule_index))
                total_invoice_source_amt += float(Invoice['inv_match_source_amt'])
                match_rule = rule_index
                break  # Exit the inner loop when a match is found

        if matching_invoices:  # Check if any matching invoices were found
            break  # Exit the outer loop if a match is found

    if total_invoice_source_amt == float(T5['fin_source_amt']):
        return matching_invoices, match_rule

    return None, None
